<div class="container">
	<h1>Forum</h1>
	
	<% if @user.try(:role) == "admin" %>
		<%= link_to "後台" , admin_topics_path , :class => "btn btn-danger" %>
	<% end %>
	<%= link_to "About" , about_topics_path , :class => "btn btn-default pull-right" %>

	<div class="check_box">
		<% @categories.each do |c| %>
			<%= link_to c.name , topics_path(:keyword => c) , :class => "btn btn-warning" %>
		<% end %>
		<%= link_to "Default" , topics_path , :class => "btn btn-warning" %>
	</div>

	<div class="sort">
		<%= link_to "Sort by last Reply" , topics_path( :order => "Update" , :keyword => @search_by ) , :class => "btn btn-primary" %>
		<%= link_to "Sort by Count of Reply" , topics_path( :order => "Reply" , :keyword => @search_by ) , :class => "btn btn-primary" %>
		<%= link_to "Sort by Count of Views" , topics_path( :order => "Views" , :keyword => @search_by ) , :class => "btn btn-primary" %>
		<%= link_to "Sort by Default" , topics_path(:keyword => @search_by ) , :class => "btn btn-primary" %>
		<%= link_to "New" , new_topic_path , :class => "btn btn-primary" %>
	</div>
		
	<br>
	<%= paginate @topics %>
	

	<table class="table table-striped">
		<tr>
			<th>主題</th>
			<th>發文者</th>
			<th>最後回覆時間</th>
			<th>回覆</th>
			<th>瀏覽數</th>
		</tr>
		
		<% @topics.each do |t| %>
			<tr>
				<td><%= link_to t.title , topic_path(t) %></td>
				<td><%= link_to t.user.email , user_path(t.user) %></td>
				<% if params.try(:order) == 'Update' %>
					<td><%= t.comments.last.try(:created_at) %></td>
				<% else %>
					<td><%= t.comments.first.try(:created_at) %></td>
				<% end %>
				<td><%= t.comments_count %></td>
				<td><%= t.views_count %></td>
			</tr>
		<% end %>
	</table>
</div>
	

